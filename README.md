# Agent Teams Monitor

å®æ—¶ç›‘æ§ Claude Code Agent Teams ä¹‹é—´ JSON æ–‡ä»¶é€šä¿¡çš„ Web åº”ç”¨ã€‚

## å·¥ä½œåŸç†

Claude Code çš„ Agent Teams åŠŸèƒ½é‡‡ç”¨æå…¶æœ´ç´ çš„é€šä¿¡æœºåˆ¶ï¼š**æ–‡ä»¶ç³»ç»Ÿæ¶ˆæ¯é˜Ÿåˆ—**ã€‚

### æ ¸å¿ƒé€šä¿¡æœºåˆ¶

Agent Teams é€šè¿‡ä»¥ä¸‹æ–¹å¼é€šä¿¡ï¼š

1. **å›¢é˜Ÿé…ç½®**: `~/.claude/teams/{teamId}/config.json`
   - åŒ…å«å›¢é˜Ÿæˆå‘˜ä¿¡æ¯å’Œä»»åŠ¡åˆ—è¡¨å…³è”

2. **Agent Inbox**: `~/.claude/teams/{teamId}/inboxes/{agentName}.json`
   - æ¯ä¸ª agent æœ‰ç‹¬ç«‹çš„ inbox æ–‡ä»¶
   - æ”¶åˆ°çš„æ¶ˆæ¯ä¼šè¿½åŠ åˆ°è¿™ä¸ªæ–‡ä»¶ï¼ˆJSON æ•°ç»„ï¼‰
   - æ¶ˆæ¯åŒ…å«ï¼šfromã€textã€summaryã€timestampã€read ç­‰å­—æ®µ

3. **ä»»åŠ¡å­˜å‚¨**: `~/.claude/tasks/{teamId}/{taskId}.json`
   - ä»»åŠ¡è¯¦ç»†ä¿¡æ¯å’ŒçŠ¶æ€
   - æ”¯æŒ blockedBy ä¾èµ–å…³ç³»

4. **æ¶ˆæ¯ç±»å‹**:
   - **æ™®é€š DM**: æ–‡æœ¬å¯¹è¯æ¶ˆæ¯
   - **åè®®æ¶ˆæ¯**: JSON å­—ç¬¦ä¸²åŒ…è£¹çš„ç³»ç»Ÿæ¶ˆæ¯
     - `idle_notification`: agent ç©ºé—²é€šçŸ¥
     - `shutdown_request`: å…³é—­è¯·æ±‚
     - `shutdown_response`: å…³é—­å“åº”
     - `plan_approval_request`: è®¡åˆ’æ‰¹å‡†è¯·æ±‚

### æŠ€æœ¯æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     æ–‡ä»¶ç›‘æ§      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Claude Code    â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  chokidar        â”‚
â”‚  Agent Teams    â”‚                   â”‚  File Watcher    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                                     â”‚
       â”‚ JSON æ–‡ä»¶è¯»å†™                       â”‚ Socket.IO
       â”‚                                     â–¼
       â”‚                             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚  Web Dashboard   â”‚
              å®æ—¶åŒæ­¥                  â”‚  (Next.js)       â”‚
                                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ ¸å¿ƒç»„ä»¶**:
- **chokidar**: ç›‘æ§ `~/.claude/teams/` å’Œ `~/.claude/tasks/` ç›®å½•å˜åŒ–
- **Socket.IO**: å®æ—¶æ¨é€æ–‡ä»¶å˜æ›´åˆ° Web ç•Œé¢
- **Next.js**: æä¾› Web ç›‘æ§é¢æ¿

### Agent ä¸Šä¸‹æ–‡ç®¡ç†

Claude Code ä½¿ç”¨ Node.js çš„ **AsyncLocalStorage** å®ç° agent ä¸Šä¸‹æ–‡éš”ç¦»ï¼š

```javascript
var T7A = new AsyncLocalStorage();
function getTeammateContext() { return T7A.getStore(); }
function runWithTeammateContext(ctx, fn) { return T7A.run(ctx, fn); }
```

**ä¸¤ç§è¿è¡Œæ¨¡å¼**:
- **in-process**: åœ¨ä¸»è¿›ç¨‹å†…ç”¨ AsyncLocalStorage éš”ç¦»
- **tmux**: åœ¨ç‹¬ç«‹ tmux pane é‡Œè¿è¡Œå®Œå…¨ç‹¬ç«‹çš„è¿›ç¨‹

### æ¶ˆæ¯æŠ•é€’æ—¶æœº

æ¶ˆæ¯åªåœ¨ **conversation turn ä¹‹é—´** æŠ•é€’ï¼š

1. ä¸€ä¸ª turn = ä¸€ä¸ª Claude API è°ƒç”¨å‘¨æœŸ
2. agent æ­£åœ¨æ‰§è¡Œæ—¶æ”¶ä¸åˆ°æ¶ˆæ¯
3. åªæœ‰ turn å®Œæˆåæ‰ä¼šæ£€æŸ¥ inbox

è¿™å¯èƒ½å¯¼è‡´ä¸€ä¸ª bugï¼štmux æ¨¡å¼ä¸‹ï¼Œæ–° spawn çš„ teammate å¦‚æœæ²¡æœ‰å®Œæˆç¬¬ä¸€ä¸ª turnï¼Œæ°¸è¿œä¸ä¼šå¼€å§‹è½®è¯¢ inboxã€‚

## æŠ€æœ¯æ ˆ

- **æ¡†æ¶**: Next.js 15 (App Router)
- **è¯­è¨€**: TypeScript
- **æ ·å¼**: Tailwind CSS v4
- **UI ç»„ä»¶**: shadcn/ui
- **åŠ¨ç”»**: Framer Motion
- **ä¸»é¢˜**: next-themes
- **å®æ—¶é€šä¿¡**: Socket.IO
- **æ–‡ä»¶ç›‘æ§**: chokidar
- **çŠ¶æ€ç®¡ç†**: Zustand

## é¡¹ç›®ç»“æ„

```
agent-teams-monitor/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app/                      # Next.js App Router
â”‚   â”‚   â”œâ”€â”€ api/                  # API è·¯ç”±
â”‚   â”‚   â”‚   â”œâ”€â”€ teams/            # å›¢é˜Ÿæ•°æ® API
â”‚   â”‚   â”‚   â”œâ”€â”€ tasks/            # ä»»åŠ¡æ•°æ® API
â”‚   â”‚   â”‚   â””â”€â”€ inbox/            # æ¶ˆæ¯æ•°æ® API
â”‚   â”‚   â”œâ”€â”€ layout.tsx            # æ ¹å¸ƒå±€
â”‚   â”‚   â””â”€â”€ page.tsx              # ç›‘æ§é¢æ¿é¡µé¢
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ ui/                   # shadcn/ui ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ animations/           # Framer Motion åŠ¨ç”»
â”‚   â”‚   â”œâ”€â”€ teams/                # å›¢é˜Ÿç›¸å…³ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ tasks/                # ä»»åŠ¡ç›¸å…³ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ inbox/                # æ¶ˆæ¯ç›¸å…³ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ layout/               # å¸ƒå±€ç»„ä»¶
â”‚   â”‚   â””â”€â”€ providers/            # React Context æä¾›è€…
â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â”œâ”€â”€ types/                # TypeScript ç±»å‹å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ services/             # æ•°æ®æœåŠ¡å±‚
â”‚   â”‚   â”œâ”€â”€ stores/               # Zustand çŠ¶æ€ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ hooks/                # è‡ªå®šä¹‰ React Hooks
â”‚   â”‚   â”œâ”€â”€ socket/               # Socket.IO å®¢æˆ·ç«¯
â”‚   â”‚   â””â”€â”€ constants/            # å¸¸é‡é…ç½®
â”‚   â””â”€â”€ middleware.ts             # Next.js ä¸­é—´ä»¶
â”œâ”€â”€ server/
â”‚   â”œâ”€â”€ index.ts                  # è‡ªå®šä¹‰æœåŠ¡å™¨å…¥å£
â”‚   â”œâ”€â”€ socket/                   # Socket.IO æœåŠ¡å™¨
â”‚   â”‚   â”œâ”€â”€ server.ts             # Socket.IO é…ç½®
â”‚   â”‚   â””â”€â”€ handlers.ts           # äº‹ä»¶å¤„ç†å™¨
â”‚   â””â”€â”€ watchers/                 # æ–‡ä»¶ç›‘æ§å™¨
â”‚       â”œâ”€â”€ index.ts              # ç›‘æ§ç®¡ç†å™¨
â”‚       â”œâ”€â”€ team-watcher.ts       # å›¢é˜Ÿé…ç½®ç›‘æ§
â”‚       â”œâ”€â”€ task-watcher.ts       # ä»»åŠ¡æ–‡ä»¶ç›‘æ§
â”‚       â””â”€â”€ inbox-watcher.ts      # æ¶ˆæ¯æ–‡ä»¶ç›‘æ§
â”œâ”€â”€ skills/                       # Agent Teams Playbook Skill
â”‚   â””â”€â”€ agent-teams-playbook/     # å¤š Agent ç¼–æ’æ‰‹å†Œ
â”œâ”€â”€ public/                       # é™æ€èµ„æº
â”œâ”€â”€ .env.local                    # ç¯å¢ƒå˜é‡é…ç½®
â”œâ”€â”€ next.config.mjs               # Next.js é…ç½®
â”œâ”€â”€ tailwind.config.ts            # Tailwind CSS é…ç½®
â””â”€â”€ tsconfig.json                 # TypeScript é…ç½®
```

## é…ç½®

### 1. å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿

```bash
cp .env.local.example .env.local
```

### 2. ç¼–è¾‘ .env.local

æ ¹æ®ä½ çš„ç³»ç»Ÿé…ç½® Claude è·¯å¾„ï¼š

```bash
# Claude ç›®å½•è·¯å¾„ï¼ˆWindows ä½¿ç”¨æ­£æ–œæ ï¼‰
CLAUDE_DIR=C:/Users/YOUR_USERNAME/.claude

# WebSocket URL
NEXT_PUBLIC_WS_URL=ws://localhost:3000

# CORS é…ç½®ï¼ˆå¦‚éœ€è¦ï¼‰
CORS_ORIGINS=http://localhost:3000,http://localhost:3001
```

## å®‰è£…ä¸è¿è¡Œ

### å®‰è£…ä¾èµ–

```bash
npm install
```

### è¿è¡Œå¼€å‘æœåŠ¡å™¨

```bash
npm run dev
```

è®¿é—® [http://localhost:3000](http://localhost:3000) æŸ¥çœ‹ç›‘æ§é¢æ¿ã€‚

### æ„å»ºç”Ÿäº§ç‰ˆæœ¬

```bash
npm run build
npm start
```

## åŠŸèƒ½ç‰¹æ€§

### å½“å‰å·²å®ç° (v0.1.0)

#### ğŸ  ä»ªè¡¨æ¿
- **å›¢é˜Ÿæ¦‚è§ˆ**: æ´»è·ƒå›¢é˜Ÿæ•°é‡ç»Ÿè®¡
- **ä»»åŠ¡æ¦‚è§ˆ**: è¿›è¡Œä¸­å’Œå·²å®Œæˆçš„ä»»åŠ¡æ•°é‡
- **æ¶ˆæ¯æ¦‚è§ˆ**: æœªè¯»æ¶ˆæ¯ç»Ÿè®¡

#### ğŸ‘¥ å›¢é˜Ÿé¡µé¢
- æŸ¥çœ‹æ‰€æœ‰æ´»è·ƒçš„ Agent Teams
- æŸ¥çœ‹å›¢é˜Ÿæˆå‘˜é…ç½®
- æŸ¥çœ‹å›¢é˜Ÿæè¿°å’ŒçŠ¶æ€

#### ğŸ“¨ æ¶ˆæ¯æ”¶ä»¶ç®±
- æŸ¥çœ‹æ‰€æœ‰ agent é—´çš„é€šä¿¡æ¶ˆæ¯
- åŒºåˆ†å·²è¯»/æœªè¯»æ¶ˆæ¯
- æ˜¾ç¤ºæ¶ˆæ¯å‘é€è€…ã€æ—¶é—´æˆ³å’Œå†…å®¹æ‘˜è¦

### è§„åˆ’ä¸­åŠŸèƒ½

- [ ] ä»»åŠ¡è¯¦æƒ…é¡µé¢ï¼ˆä¾èµ–å…³ç³»å¯è§†åŒ–ï¼‰
- [ ] æ¶ˆæ¯è¿‡æ»¤å’Œæœç´¢
- [ ] å®æ—¶ Socket.IO è¿æ¥
- [ ] åè®®æ¶ˆæ¯é«˜äº®æ˜¾ç¤º
- [ ] Agent çŠ¶æ€å®æ—¶æ›´æ–°

## æµ‹è¯• Agent Teams

åˆ›å»ºä¸€ä¸ªæµ‹è¯•å›¢é˜Ÿæ¥éªŒè¯ç›‘æ§åŠŸèƒ½ï¼š

1. åœ¨ Claude Code ä¸­ä½¿ç”¨ `TeamCreate` åˆ›å»ºå›¢é˜Ÿ
2. æ·»åŠ å¤šä¸ª agents
3. è®©å®ƒä»¬äº’ç›¸å‘é€æ¶ˆæ¯
4. è§‚å¯Ÿç›‘æ§ç•Œé¢å®æ—¶æ›´æ–°

## å·²çŸ¥é—®é¢˜

Claude Code Agent Teams çš„ä¸€äº›å·²çŸ¥é™åˆ¶ï¼š

| Issue | æè¿° | çŠ¶æ€ |
|-------|------|------|
| Context Compaction | é•¿ä»»åŠ¡åä¸Šä¸‹æ–‡å‹ç¼©å¯¼è‡´å›¢é˜Ÿæ„ŸçŸ¥ä¸¢å¤± | OPEN |
| Agent ç”Ÿå‘½å‘¨æœŸ | é‡å¤ spawnã€è½®è¯¢æµªè´¹ | OPEN |
| MEMORY.md å¹¶å‘ | å¤š teammate åŒæ—¶å†™ä¼šè¦†ç›– | OPEN |
| ä»»åŠ¡é€šçŸ¥æ·¹æ²¡ | TaskUpdate åŠ é€Ÿä¸Šä¸‹æ–‡æ¶ˆè€— | OPEN |

## æ•…éšœæ’é™¤

### æ–‡ä»¶ç›‘æ§ä¸å·¥ä½œ

- æ£€æŸ¥ `CLAUDE_DIR` è·¯å¾„æ˜¯å¦æ­£ç¡®
- ç¡®è®¤æœåŠ¡å™¨æœ‰è¯»å–æƒé™
- éªŒè¯ `~/.claude/teams/` ç›®å½•å­˜åœ¨

### Socket.IO è¿æ¥å¤±è´¥

- æ£€æŸ¥ `NEXT_PUBLIC_WS_URL` é…ç½®
- æŸ¥çœ‹ CORS è®¾ç½®
- æ£€æŸ¥é˜²ç«å¢™è®¾ç½®

### æ•°æ®ä¸æ›´æ–°

- ç¡®è®¤ Claude Code æ­£åœ¨è¿è¡Œä¸”æœ‰æ´»è·ƒå›¢é˜Ÿ
- æ£€æŸ¥æ–‡ä»¶ç›‘æ§å™¨æ˜¯å¦æ­£å¸¸å¯åŠ¨
- æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯ä¿¡æ¯

## Agent Teams Playbook

é¡¹ç›®å†…ç½®äº† **Agent Teams Playbook** Skillï¼Œæä¾›å¤š Agent åä½œç¼–æ’æŒ‡å—ï¼š

- 5 å¤§ç¼–æ’åœºæ™¯
- 6 é˜¶æ®µå·¥ä½œæµ
- Skill è‡ªåŠ¨å‘ç°
- è´¨é‡æŠŠå…³æœºåˆ¶

è¯¦è§ `skills/agent-teams-playbook/` ç›®å½•ã€‚

## å‚è€ƒèµ„æº

- [Claude Code å®˜æ–¹æ–‡æ¡£](https://docs.anthropic.com)
- [Agent Teams GitHub Issues](https://github.com/anthropics/claude-code/issues)
- [Agent Teams åŸç†è§£æ](https://zhuanlan.zhihu.com/p/2006043401418715855)

## License

MIT
